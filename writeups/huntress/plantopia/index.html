<!doctype html><html lang=en><head><meta charset=utf-8><title> Plantopia</title><meta content="width=device-width,initial-scale=1.0" name=viewport><link href=https://yctf.ch/css/main.css rel=stylesheet><link as=font crossorigin href=https://yctf.ch/fonts/JetBrainsMono-VariableFont_wght.ttf rel=preload type=font/ttf><link href=https://yctf.ch/rss.xml rel=alternate title=RSS type=application/rss+xml><link href=https://yctf.ch/atom.xml rel=alternate title=RSS type=application/atom+xml><script crossorigin src=https://cdn.jsdelivr.net/npm/@twemoji/api@latest/dist/twemoji.min.js></script><script crossorigin src=https://cdn.jsdelivr.net/npm/fuse.js@7.1.0/dist/fuse.basic.min.js></script><script defer src=https://yctf.ch/js/main.js></script><script defer src=https://yctf.ch/search_index.en.js></script><body class=min-h-[100svh]><div class="w-[50svw] md:w-96 bg-popover absolute left-1/2 top-1/3 transform -translate-x-1/2 -translate-y-1/2 hidden shadow-lg" id=goto-popup><input class="w-full h-8 lg:h-12 px-2 py-1 lg:px-4 lg:py-2" id=goto-input placeholder=Search><div class="w-full h-0.5 bg-muted"></div><div class="w-full max-h-96 overflow-y-auto flex flex-col" id=goto-results></div></div><a class="top-0 left-0 fixed" href=https://yctf.ch> <div class="h-18 md:h-26 lg:h-32 p-2 md:p-4"><div class="w-full h-full flex items-center justify-center"><div class="w-full h-full [&>svg]:w-full [&>svg]:h-full [&>svg]:object-contain invert-colors select-none"><svg viewbox="0 0 300 300" fill=none xmlns=http://www.w3.org/2000/svg><g class=text-container><text style="text-transform:none;letter-spacing:normal;white-space:pre;fill:#e63e3d;fill-opacity:1;direction:ltr;font-family:JetBrains Mono;font-size:129px;font-style:normal;font-weight:800;text-decoration:none" class=fills dominant-baseline=ideographic lengthadjust=spacingAndGlyphs textlength=77.406 x=49.297 y=171.602>Y</text></g><g class=text-container><text style="text-transform:none;letter-spacing:normal;white-space:pre;fill:#e63e3d;fill-opacity:1;direction:ltr;font-family:JetBrains Mono;font-size:129px;font-style:normal;font-weight:800;text-decoration:none" class=fills dominant-baseline=ideographic lengthadjust=spacingAndGlyphs textlength=77.406 x=173.297 y=171.602>C</text></g><g class=text-container><text style="text-transform:none;letter-spacing:normal;white-space:pre;fill:#e63e3d;fill-opacity:1;direction:ltr;font-family:JetBrains Mono;font-size:129px;font-style:normal;font-weight:800;text-decoration:none" class=fills dominant-baseline=ideographic lengthadjust=spacingAndGlyphs textlength=77.406 x=49.297 y=297.602>T</text></g><g class=text-container><text style="text-transform:none;letter-spacing:normal;white-space:pre;fill:#e63e3d;fill-opacity:1;direction:ltr;font-family:JetBrains Mono;font-size:129px;font-style:normal;font-weight:800;text-decoration:none" class=fills dominant-baseline=ideographic lengthadjust=spacingAndGlyphs textlength=77.406 x=173.297 y=297.602>F</text></g></svg></div></div></div> </a><div class="text-secondary-foreground mx-6 md:py-2 py-1 font-black text-lg lg:text-xl top-0 right-0 fixed w-18 md:w-26 h-18 md:h-26 lg:h-32 p-2 md:p-4 text-center flex items-center justify-center"></div><main id=scroll-element><div class="mt-24 mx-4 mb-24 sm:mx-0"><article class="prose dark:prose-invert mx-auto lg:prose-lg"><h1>Plantopia <span class="text-muted-foreground text-xl">by Tyr</span></h1><div class="flex flex-row gap-4 items-center"><span><strong>2024-09-30</strong></span><span class=text-muted-foreground>(2 min. read)</span> - <span class="flex flex-row gap-2"> </span><div class=flex-grow></div></div><h2 id=description>Description</h2><p>Plantopia is our brand-new, cutting-edge plant care management website! Designed for hobbyists and professionals alike, it's your one-stop shop for all plant care needs.<p>Please perform a penetration test before our site launch and let us know if you find any issues.<p>Username: <code>testuser</code><br> Password: <code>testpassword</code><p><strong>Press the <code>Start</code> button on the top-right to begin this challenge.</strong><hr><p>As expected, we see a login page where we can use the provided credentials to access the website. <img alt src=https://i.imgur.com/ebmAwzH.png><p>While exploring, we find an API Docs page with Swagger that lists several web requests: <img alt src=https://i.imgur.com/05AyLWj.png><p>For authentication, we need a session cookie, so let's intercept the traffic using Burp Suite. <img alt src=https://i.imgur.com/f1pk6dQ.png><p>Here is the session cookie: <code>dGVzdHVzZXIuMC4xNzMwMzA0Mjgw</code>. Decoded from base64, it reveals <code>testuser.0.1730304280</code>:<ul><li><code>testuser</code>: the username in use<li><code>0</code>: a role indicator or user type<li><code>1730304280</code>: a UNIX timestamp, likely the session expiration date or creation time</ul><p>With this session cookie, the only available HTTP request in Swagger is <code>GET /api/plants</code>. Let's see if modifying it works. <img alt src=https://i.imgur.com/Mzu8hWc.png><p>Success! We're now logged in as <code>admin</code> by changing the values to <code>admin.1.1730304280</code> and encoding it as <code>YWRtaW4uMS4xNzMwMzA0Mjgw</code>. Using the <a href=https://cookie-editor.com>Cookie-Editor browser extension </a>, we can make this session cookie persistent. <img alt src=https://i.imgur.com/dtDuUvL.png><p>In the <code>Admin</code> page, we can select a plant and modify various data related to it. One of the options sends an alert message with <code>/usr/sbin/sendmail -t</code>. Since this command is triggered via the API Docs, we add <code>&& ls -al</code> to it and trigger it. <img alt src=https://i.imgur.com/oX0qQao.png><p>To execute, we enter our admin session cookie and select the plant ID with the modified alert command (which is <code>1</code> in this case). <img alt src=https://i.imgur.com/IjYLTEO.png><p>It worked! Our command was executed successfully. <img alt src=https://i.imgur.com/cQaSN4i.png><p>But where can we view the output?.. If you noticed earlier, we now have access to the <code>Logs</code> page. Perfect! <img alt src=https://i.imgur.com/xXtXqny.png><p>Here, we see the command output, showing the <code>flag.txt</code> file in the current directory. Replacing <code>ls -al</code> with <code>cat flag.txt</code>, we trigger the command again and check the logs. <img alt src=https://i.imgur.com/SFVchBw.png><p>The flag is: <code>flag{c29c4d53fc432f7caeb573a9f6eae6c6}</code></article></div></main><div class="bg-secondary text-primary-foreground w-fit fixed bottom-4 float-right right-8 transition-all duration-200 opacity-0" title="Scroll to top" id=scroll-to-top><div class="bg-primary h-full absolute -z-10" id=scroll-fill></div><svg class="h-6 w-6 mx-4 md:my-2 my-1 fill-primary-foreground" viewbox="0 0 16 16" xmlns=http://www.w3.org/2000/svg><path d="M3.47 7.78a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0l4.25 4.25a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018L9 4.81v7.44a.75.75 0 0 1-1.5 0V4.81L4.53 7.78a.75.75 0 0 1-1.06 0Z"></path></svg></div>