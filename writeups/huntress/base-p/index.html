<!doctype html><html lang=en><head><meta charset=utf-8><title> Base-p-</title><meta content="width=device-width,initial-scale=1.0" name=viewport><link href=https://yctf.ch/css/main.css rel=stylesheet><link as=font crossorigin href=https://yctf.ch/fonts/JetBrainsMono-VariableFont_wght.ttf rel=preload type=font/ttf><link href=https://yctf.ch/rss.xml rel=alternate title=RSS type=application/rss+xml><link href=https://yctf.ch/atom.xml rel=alternate title=RSS type=application/atom+xml><script crossorigin src=https://cdn.jsdelivr.net/npm/@twemoji/api@latest/dist/twemoji.min.js></script><script crossorigin src=https://cdn.jsdelivr.net/npm/fuse.js@7.1.0/dist/fuse.basic.min.js></script><script defer src=https://yctf.ch/js/main.js></script><script defer src=https://yctf.ch/search_index.en.js></script><body class=min-h-[100svh]><div class="w-[50svw] md:w-96 bg-popover absolute left-1/2 top-1/3 transform -translate-x-1/2 -translate-y-1/2 hidden shadow-lg" id=goto-popup><input class="w-full h-8 lg:h-12 px-2 py-1 lg:px-4 lg:py-2" id=goto-input placeholder=Search><div class="w-full h-0.5 bg-muted"></div><div class="w-full max-h-96 overflow-y-auto flex flex-col" id=goto-results></div></div><div class="fixed top-0 left-0 w-full z-10 md:bg-transparent bg-background/80 backdrop-blur-md md:backdrop-blur-none shadow-sm md:shadow-none flex items-center justify-between px-4 md:px-8 h-18 md:h-26 lg:h-32"><a class="flex items-center h-full" href=https://yctf.ch> <div class="h-18 md:h-26 lg:h-32 p-2 md:p-4"><div class="w-full h-full flex items-center justify-center"><div class="w-full h-full [&>svg]:w-full [&>svg]:h-full [&>svg]:object-contain invert-colors select-none"><svg viewbox="0 0 300 300" fill=none xmlns=http://www.w3.org/2000/svg><g class=text-container><text style="text-transform:none;letter-spacing:normal;white-space:pre;fill:#e63e3d;fill-opacity:1;direction:ltr;font-family:JetBrains Mono;font-size:129px;font-style:normal;font-weight:800;text-decoration:none" class=fills dominant-baseline=ideographic lengthadjust=spacingAndGlyphs textlength=77.406 x=49.297 y=171.602>Y</text></g><g class=text-container><text style="text-transform:none;letter-spacing:normal;white-space:pre;fill:#e63e3d;fill-opacity:1;direction:ltr;font-family:JetBrains Mono;font-size:129px;font-style:normal;font-weight:800;text-decoration:none" class=fills dominant-baseline=ideographic lengthadjust=spacingAndGlyphs textlength=77.406 x=173.297 y=171.602>C</text></g><g class=text-container><text style="text-transform:none;letter-spacing:normal;white-space:pre;fill:#e63e3d;fill-opacity:1;direction:ltr;font-family:JetBrains Mono;font-size:129px;font-style:normal;font-weight:800;text-decoration:none" class=fills dominant-baseline=ideographic lengthadjust=spacingAndGlyphs textlength=77.406 x=49.297 y=297.602>T</text></g><g class=text-container><text style="text-transform:none;letter-spacing:normal;white-space:pre;fill:#e63e3d;fill-opacity:1;direction:ltr;font-family:JetBrains Mono;font-size:129px;font-style:normal;font-weight:800;text-decoration:none" class=fills dominant-baseline=ideographic lengthadjust=spacingAndGlyphs textlength=77.406 x=173.297 y=297.602>F</text></g></svg></div></div></div> </a><div class="text-secondary-foreground font-black text-lg lg:text-xl text-center flex items-center justify-center gap-2"></div></div><main id=scroll-element><div class="mt-24 mx-4 mb-24 sm:mx-0"><article class="prose dark:prose-invert mx-auto lg:prose-lg"><h1>Base-p- <span class="text-muted-foreground text-xl">by Tyr</span></h1><div class="flex flex-row gap-4 items-center"><span><strong>2024-09-30</strong></span><span class=text-muted-foreground>(2 min. read)</span> - <span class="flex flex-row gap-2"> <a class="bg-accent text-accent-foreground px-2 py-1 rounded-md text-sm w-fit font-bold no-underline" href=/categories/misc> misc </a> </span><div class=flex-grow></div><button class=cursor-pointer onclick=toggleAssets()><svg class="h-6 w-6 fill-none stroke-accent" viewbox="0 0 24 24" stroke-linecap=round stroke-linejoin=round stroke-width=2 xmlns=http://www.w3.org/2000/svg><path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"></path></svg></button></div><div class="hidden px-2 py-1 md:px-4 md:py-2 border border-muted my-4" id=assets-container><div class="flex flex-wrap gap-3"><a class="inline-flex items-center gap-1 text-sm hover:text-primary transition-colors" href=/writeups/huntress/base-p/files/ahgjWqZ.png> <svg class="w-4 h-4" viewbox="0 0 24 24" fill=currentColor><path d="M8.5,13.5L11,16.5L14.5,12L19,18H5M21,19V5C21,3.89 20.1,3 19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19Z"/></svg> ahgjWqZ.png </a><a class="inline-flex items-center gap-1 text-sm hover:text-primary transition-colors" href=/writeups/huntress/base-p/files/aufYRcl.png> <svg class="w-4 h-4" viewbox="0 0 24 24" fill=currentColor><path d="M8.5,13.5L11,16.5L14.5,12L19,18H5M21,19V5C21,3.89 20.1,3 19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19Z"/></svg> aufYRcl.png </a><a class="inline-flex items-center gap-1 text-sm hover:text-primary transition-colors" href=/writeups/huntress/base-p/files/s2kkQSH.png> <svg class="w-4 h-4" viewbox="0 0 24 24" fill=currentColor><path d="M8.5,13.5L11,16.5L14.5,12L19,18H5M21,19V5C21,3.89 20.1,3 19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19Z"/></svg> s2kkQSH.png </a></div></div><h2 id=description>Description</h2><p>Base-p- 500 points - Miscellaneous - 9 Solves<p>Author: Izzy Spering<p>That looks like a weird encoding, I wonder what it's based on.<p>Download the file(s) below.<hr><p>First, let's take a look at the content of the <code>based.txt</code> file:<pre class=z-code><code><span class="z-text z-plain">楈繳籁萰杁癣怯蘲詶歴蝕絪敪ꕘ橃鹲𠁢腂𔕃饋𓁯𒁊鹓湵蝱硦楬驪腉繓鵃舱𒅡繃絎罅陰罌繖𔕱蝔浃虄眵虂𒄰𓉋詘襰ꅥ破ꌴ顂𔑫硳蕈訶𒀹饡鵄腦蔷樸𠁺襐浸椱欱蹌ꍣ鱙癅腏葧𔕇鱋鱸𓁮聊聍ꄸꈴ陉𔕁框ꅔ𔕩𔕃驂虪祑𓅁聨朸聣摸眲葮𖠳鵺穭𒁭豍摮饱恕𓉮詔葉鰸葭楷洳面𔕃𔑒踳𔐸杅𐙥湳橹驳陪楴氹橬𓄱蝔晏稸ꄸ防癓ꉁ𖡩鵱聲ꍆ稸鬶魚𓉯艭𔕬輷茳筋𔑭湰𓄲怸艈恧襺陷项譶ꍑ衮汮蹆杗筌蹙怰晘缸睰脹蹃鹬ꕓ脶湏赑魶繡罢𒉁荶腳ꌳ蕔𔐶橊欹𖥇繋赡𐙂饎罒鵡𒉮腙ꍮ楑恤魌虢昹𒅶效楙衎𔕙ꉨ𓈸𔑭樯筶筚絮𓁗浈豱ꉕ魔魧蕕聘筣鹖樫ꍖ汸湖萰腪轪𓉱艱絍笹艨魚詇腁𒁮陴顮虂癁
</span></code></pre><p>Well, I don't understand that much. Probably an encoding of some kind. But something about the name of the challenge caught my attention: <strong>Base-p-</strong>. This reminds me of the <code>-p-</code> parameter in <strong>nmap</strong>, which is used to specify the range of ports (from <code>1</code> to <code>65535</code>). This made me think it could be <code>base65536</code> encoding.<p>Let's try to decode it using an <a href=https://www.better-converter.com/Encoders-Decoders/Base65536-Decode>online base65536 decoder</a>:<pre class=z-code><code><span class="z-text z-plain">H4sIAG0OA2cA/+2QvUt6URjHj0XmC5ribzBLCwKdorJoSiu9qRfCl4jeILSICh1MapCINHEJpaLJVIqwTRC8DQ5BBQ0pKtXUpTej4C4lBckvsCHP6U9oadDhfL7P85zzPTx81416LYclYgEAOLgOGwKgxgnrJKMK8j4kIaAwF3TjiwCwBejQQDAshK82cKx/2BnO3xzhmEmoMWn/qdU+ntTUIO8gmOw438bbCwRv3Y8vE2ens9y5sejat497l51sTRO18E8j2aSAAkixqhrKFl8E6fZfotmMlw7Z3NKFmvp92s8+HMg+zTwaycvVQlnSn7FYW2LFYY0+X18JpB9LCYliSm6LO9QXvfaIbJAqvNsL3lTP6vJ596GyKIaXBnNdRJahnqYLnlQ4d+LfbQ91vpH0Y4NSYwhk8tmv/5vFZFnHWrH8qWUkTfgfUPXKcFVi+5Vlx7V90OjLjZqtqMMH9FhMZfGUALnotancBQAA
</span></code></pre><p>This output looks like base64 encoding. Let's decode it again, this time using a base64 decoder:<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-support z-function z-echo z-shell">echo</span></span><span class="z-meta z-function-call z-arguments z-shell"> <span class="z-string z-quoted z-double z-shell"><span class="z-punctuation z-definition z-string z-begin z-shell">"</span>H4sIAG0OA2cA/+2QvUt6URjHj0XmC5ribzBLCwKdorJoSiu9qRfCl4jeILSICh1MapCINHEJpaLJVIqwTRC8DQ5BBQ0pKtXUpTej4C4lBckvsCHP6U9oadDhfL7P85zzPTx81416LYclYgEAOLgOGwKgxgnrJKMK8j4kIaAwF3TjiwCwBejQQDAshK82cKx/2BnO3xzhmEmoMWn/qdU+ntTUIO8gmOw438bbCwRv3Y8vE2ens9y5sejat497l51sTRO18E8j2aSAAkixqhrKFl8E6fZfotmMlw7Z3NKFmvp92s8+HMg+zTwaycvVQlnSn7FYW2LFYY0+X18JpB9LCYliSm6LO9QXvfaIbJAqvNsL3lTP6vJ596GyKIaXBnNdRJahnqYLnlQ4d+LfbQ91vpH0Y4NSYwhk8tmv/5vFZFnHWrH8qWUkTfgfUPXKcFVi+5Vlx7V90OjLjZqtqMMH9FhMZfGUALnotancBQAA<span class="z-punctuation z-definition z-string z-end z-shell">"</span></span></span> <span class="z-keyword z-operator z-logical z-pipe z-shell">|</span> <span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">base64</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>d</span> <span class="z-keyword z-operator z-assignment z-redirection z-shell">></span> decoded_output</span>
</span></code></pre><p>By inspecting the file type using the <code>file</code> command, we discover it is a compressed gzip file:<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">file</span></span><span class="z-meta z-function-call z-arguments z-shell"> decoded_output</span>
</span></code></pre><p><img alt src=https://yctf.ch/writeups/huntress/base-p/files/ahgjWqZ.png><p>Let's rename it with the <code>.gz</code> extension and decompress it:<pre class="language-bash z-code" data-lang=bash><code class=language-bash data-lang=bash><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">mv</span></span><span class="z-meta z-function-call z-arguments z-shell"> decoded_output decoded_output.gz</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">gzip</span></span><span class="z-meta z-function-call z-arguments z-shell"><span class="z-variable z-parameter z-option z-shell"><span class="z-punctuation z-definition z-parameter z-shell"> -</span>d</span> decoded_output.gz</span>
</span><span class="z-source z-shell z-bash"><span class="z-meta z-function-call z-shell"><span class="z-variable z-function z-shell">file</span></span><span class="z-meta z-function-call z-arguments z-shell"> decoded_output</span>
</span></code></pre><p>Now we have a PNG image file. <img alt src=https://yctf.ch/writeups/huntress/base-p/files/s2kkQSH.png><p>Adding the <code>.png</code>extension, and here is what it looks like: <img alt src=https://yctf.ch/writeups/huntress/base-p/files/aufYRcl.png><p>By extracting the RGB values from each square (using an <a href=https://www.ginifab.com/feeds/pms/color_picker_from_image.php>online color picker</a>), we obtain the following values:<pre class=z-code><code><span class="z-text z-plain">(102,108,97)
</span><span class="z-text z-plain">(103,123,53)
</span><span class="z-text z-plain">(56,54,99)
</span><span class="z-text z-plain">(102,56,99)
</span><span class="z-text z-plain">(56,52,57)
</span><span class="z-text z-plain">(99,57,55)
</span><span class="z-text z-plain">(51,48,101)
</span><span class="z-text z-plain">(97,55,98)
</span><span class="z-text z-plain">(50,49,49)
</span><span class="z-text z-plain">(50,102,102)
</span><span class="z-text z-plain">(102,51,57)
</span><span class="z-text z-plain">(102,102,54)
</span><span class="z-text z-plain">(97,125,32)
</span></code></pre><p>Finally, we convert these decimal values to their corresponding ASCII characters (using a <a href=https://www.coderstool.com/decimal-to-ascii>decimal-to-ASCII decoder</a>), and got the flag.<p>The flag is: <code>flag{586cf8c849c9730ea7b2112fff39ff6a}</code></article></div></main><div class="bg-secondary text-primary-foreground w-fit fixed bottom-4 float-right right-8 transition-all duration-200 opacity-0" title="Scroll to top" id=scroll-to-top><div class="bg-primary h-full absolute -z-10" id=scroll-fill></div><svg class="h-6 w-6 mx-4 md:my-2 my-1 fill-primary-foreground" viewbox="0 0 16 16" xmlns=http://www.w3.org/2000/svg><path d="M3.47 7.78a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0l4.25 4.25a.751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018L9 4.81v7.44a.75.75 0 0 1-1.5 0V4.81L4.53 7.78a.75.75 0 0 1-1.06 0Z"></path></svg></div>